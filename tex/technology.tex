\section{Technology Today}
Advancements in three major areas---networking, MCUs, and energy
harvesting---open new opportunites for networked embedded systems and generate
new implications on how an OS should manage activity, security, and privacy.

%  Need a sentence in 2 that explains what BLE is/why it's important. I.e.,
%  iBeacon, it's how mobile devices are going to interact with ubiquitous
%  computing/proximity sensor networks. Lower power than 802.15.4, etc. There is
%  no explanation of what it is, instead it jumps to TinyOS considerations.

\smallskip\noindent
\textbf{Integrating TinyOS and Bluetooth Low Energy.}
BLE provides highly efficient beaconing,
bidirectional communication, fast device discovery, authentication, and
optional pico-network formation and management~\cite{ble-overview}.
BLE explicitly incoporates ideas of periodic beacons and duty cycles,
such that a device with a wakeup latency of a second can have
an average current draw of $< 40$~\uA.\footnote{
  e.g. Nordic Semiconductor NRF8001.
}
%
Tight timing requirements mean that most chips have tightly
integrated software stacks that present limited abstractions such as
getting and setting attributes. Furthermore, these software stacks
assume a threaded, sequential execution model that in our experience
is hard to adapt efficiently to an event-driven paradigm. Integrating an
event-driven OS with manufacturer-provided software is a
challenge that a post-mote platform must address.

% The question remains open whether a sequential
% system with the same versatility as TinyOS could eliminate these
% inefficiencies.  Also, it is possible that a stack
% constructed from the ground up that leveraged event driven programming and BLE
% technology could result in an embedded system more efficient than the
% manufacturer provided software implementations.  BLE is an excellent
% technology to be used in embedded systems but integrating TinyOS with stacks
% provided by manufactures is not sustainable nor ideal for future research.

\smallskip\noindent
\textbf{Cortex M0--M4.}
Advancement in MCU technology has widened the field of low-power processors
which now ranges from highly performant cores such as the 1~\uA--30~mA,
0.5--120~MHz Atmel SAM4S with a Cortex~M4, 2~MB flash, and 160~kB SRAM to
highly efficient cores such as the 5~nW--10~\uA, 1--8~MHz M3 research
chips~\cite{lee13modular} with a Cortex~M0 and 16~kB of memory.
%
While the ultra-low power M3 resembles traditional embedded MCUs, for
the cm-scale domain powerful primitives such as memory management and dynamic
frequency scaling are becoming available.
To still meet low power targets, however, these MCUs have very complex power
management and peripheral configuration mechanisms.
The post-mote OS will need to devise new means to efficiently abstract %(near)
optimal power management for these more complex chips and leverage the new
features when available without sacrificing its utility for less feature-rich,
constrained systems.

% While these are fairly
% easy to configure and abstract if energy usage is not a concern, as in most
% Arduino-type systems, optimal energy usage requires a very close coupling
% between dynamically changing application states and peripheral configurations.

% Interesting and fair point, but more on the systems side than the MCU, which
% is the discussion here (and we only have 2 pages..)
%
% A final characteristic is that the increase in DMA channels combined with the
% ability to configure peripheral events to asynchronously trigger other
% peripherals and DMA transfers allows experienced programmers to implement
% important parts of application logic with no CPU cycles - which can
% drastically reduce the time that the CPU is spent awake. The configuration of
% such functionality is fairly hardware specific and the question of how to
% automatically use this functionality or present it to novice programmers in an
% easy to use form is challenging.

\smallskip\noindent
\textbf{Impact of Energy Harvesting.}
%Today, it is possible to obtain temperature, humidity, or light levels every
%minute or two, under dimly lit conditions, using indoor photovoltaics that
%occupy a mere 2--3~cm$^2$.
%
%It is possible to build an energy-harvesting energy meter that measures
%real power in a form factor no larger than a clip-on split-core current
%transformer.
%
A decade of research in energy-harvesting transducers, efficient power
electronics, and compact energy storage technologies, coupled
with reductions in the idle and active power of radios,
instant-on/instant-write phase-change memory, and the efficacy of modern MCUs
make compact energy-harvesting sensors that can run perpetually, even in
indoor settings, a reality~\cite{doubledip}.
%
However, writing applications for intermittently-powered,
energy-harvesting systems is a challenge.  It requires revisiting many
assumptions about system startup, maintaining state across activation cycles,
discovering and communicating with neighbors, predicting future energy
availability, and scheduling operations under energy uncertainty~\cite{dewdrop}.
%
Deriving clearer power state and availability semantics, and a means to express
what state needs to be saved, present new embedded OS challenges.

%One way to
%circumvent some of the challenges is to grossly over provision the energy
%harvesting power supply in an attempt to mask the energy intermittency and all
%that dealing with it entails.  But this drives up size and cost, and it cannot
%fully mitigate the variability inherent in energy-harvesting operation.  A
%different path exposes the variability, perhaps through richer power supply
%interfaces, to the system software which can then context switch on time or
%energy quanta, and manage continuations across activations by leveraging fast
%and efficient context storage and restoration.

